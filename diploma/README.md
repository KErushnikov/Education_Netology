# Курсовая работа "Защищённый контур" (Профессия Специалист по информационной безопасности)

## Легенда

[Legend.md](../diploma/Legend.md)

## Отчет

Проанализировав исходные данные и нормативную документацию, а именно Приказ Федеральной службы по техническому и экспортному контролю от 18 февраля 2013 г. N 21 "Об утверждении Состава и содержания организационных и технических мер по обеспечению безопасности персональных данных при их обработке в информационных системах персональных данных", можем сделать вывод о том, что заявленное разработчиком приложение "содержит механизмы безопасности и может использоваться при построении ИСПД до 4 УЗ включительно и систем, обрабатывающих коммерческую тайну". При этом стоить отметить, что номативным документом определяется четыре уровня защищенности и 4 УЗ - это минимальный уровень защищенности информационной системы, при котором законом разрешается эксплуатировать подобную систему с целью обработки персональных данных. По условиям задания необходимо проанализировать данное приложение по двум основным критериям:
* Меры по идентификации и аутентификации субъектов доступа и объектов доступа должны обеспечивать присвоение субъектам и объектам доступа уникального признака (идентификатора), сравнение предъявляемого субъектом (объектом) доступа идентификатора с перечнем присвоенных идентификаторов, а также проверку принадлежности субъекту (объекту) доступа предъявленного им идентификатора (подтверждение подлинности).
* Меры по управлению доступом субъектов доступа к объектам доступа должны обеспечивать управление правами и привилегиями субъектов доступа, разграничение доступа субъектов доступа к объектам доступа на основе совокупности установленных в информационной системе правил разграничения доступа, а также обеспечивать контроль за соблюдением этих правил.

Одной из мер, которая не соответствует даже минимальным требованиям регулятора является "Управление средствами аутентификации, в том числе хранение, выдача, инициализация, блокирование средств аутентификации и принятие мер в случае утраты и (или) компрометации средств аутентификации". Это должно быть реализовано как минимум с помощью банальной функции восстановления пароля доступа в систему по неким аутентификационным данным пользователя. Но права для управления учетными записями есть только у пользователя с правами "Администратор", где можно лишь добавить пользователя создав для него пару login-pass и выдав соответствующие права, и в случае утери восстановить пароль в данной системе невозможно, а лишь удаление существующего пользователя и создание нового. А если пользователь потерял свой логин - нет возможности и для идентификации учетной записи, которую следует удалить. Отличным примером исполнения полного функционала является например служба Active Directory, с помощью которой можно на базовом уровне завести пользователя с его логином и паролем, но и с некоторыми данными(фамилия, имя), которые будут храниться в карточке пользователя. А также приложением, по умолчанию, не предусмотрено ограничение на количество попыток аутентификации, что потенциально открывает возможности для брутфорса паролей, а так же для ddos-атак. Так же не реализовано различие в идетификаторов "внутренних" пользователей - работников оператора и "внешних" пользователей, которые работниками оператора не являются.

Если же рассмотреть меры по управлению доступом субъектов доступа к объектам доступа, то следует обратить на следующие несоответствия нормативным документам:
* УПД.1 - нет разграничения между "внутренними" и "внешиними" пользователями
* УПД.2 - нет разграничения доступа, то есть пользователь с правами "персональные данные" видит все записи в реестре, может создавать новые, а так же может редактировать и удалять существующие
* УПД.5 - Назначение минимально необходимых прав и привилегий пользователям, администраторам и лицам, обеспечивающим функционирование информационной системы. Т.е. нет необходимости, чтобы администратор системы видел и мог изменять значения во вкладках "Клиенты" и "Документы" в отношении которых введен режим комерческой тайны.
* УПД.6 - Неограниченое количество попыток входа в систему
* УПД.13-16 - Приложение запускается на порту 8888 и использует протокол HTTP для своей работы, взаимодействие с приложением осуществляется через веб-интерфейс (посредством веб-браузера с хоста), защита внешнего удаленного доступа не реализована, как не реализован и контроль использования в информационной системе беспроводного доступа и мобильных технических средств. Нет и управления взаимодействия с информационными системами сторонних организаций.

Что касается раздела с информацией, составляющей комерческую тайну, то так же нельзя не заметить нарушений. Согласно Федеральный закон от 29 июля 2004 г. N 98-ФЗ "О коммерческой тайне" меры по охране конфиденциальности информации, принимаемые ее обладателем, должны включать в себя:
1. определение перечня информации, составляющей коммерческую тайну;
2. ограничение доступа к информации, составляющей коммерческую тайну, путем установления порядка обращения с этой информацией и контроля за соблюдением такого порядка;
3. учет лиц, получивших доступ к информации, составляющей коммерческую тайну, и (или) лиц, которым такая информация была предоставлена или передана;
4. регулирование отношений по использованию информации, составляющей коммерческую тайну, работниками на основании трудовых договоров и контрагентами на основании гражданско-правовых договоров;

Если согласно п.1 перечень информации определен, не ясен функционал с возможным добавлением новых документов в реестр, который реализуется с правами обычного пользователя с доступом к КТ. Так же есть возможность скачивания и удаления существующих в реестре файлов. Таким образом должен быть реализован конечный список пользователей с доступом в этот раздел приложения, а права на редактирование содержайщейся в разделе информации должен быть строго у ограниченого круга лиц. Администратору приложения так же излишни права на просмотр и редактирование данного раздела.

Технические уязвимости.
Агрессивное сканирование nMap выявило, что на данном устройстве открыто 3 порта.

* 21/tcp   open  ftp     vsftpd 3.0.3

Используя информацию с портала Exploit-DB, выяснилось, что 21 первый порт уязвим к удаленному отказу в обслуживании Remote DoS, при запуске скрипта XYNMAPS [script.py](../diploma/script.py) возникает отказ в обслуживании легитимных запросов на сервер.
Решение: закрыть данный порт, либо обновить ПО до версии, в которой нет известных эксплойтов

* 22/tcp   open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)

Зная, что данное решение поставляется "из коробки" и открыт порт 22, мы можем попытаться зайти через ssh на сервер и узнать пароль от стандартной учетной записи с административными правами и получить доступ и к персональным данным пользователей и к документам в отношении клоторых введен режим комерческой тайны [Screenshot1.JPG](../diploma/Screenshot1.JPG)
Решение: своевременная смена паролей

* 8888/tcp open  http    Golang net/http server (Go-IPFS json-rpc or InfluxDB API)

Перейдя по ссылке http://192.168.0.1:8888 (нужный адрес мы узнали из файла /etc/network/interfaces, а точнее /etc/netplan/01-netcfg.yaml, т.к. сервис ifupdown был заменен на сервис netplan) мы попадаем в веб-интерфейс приложения. Сразу можно заметить, что приложение выдает разные ошибки при заполнении разных полей данными. Например, если ввести корректный логин, и любой набор символов в поле пароль, приложение напишет о неверном пароле. А если в поле Login ввести произвольный набор символов, приложение отреагирует иначе - сообщит пользователю/злоумышленнику, что пользователя с данным логином с системе не существует. Таким образом потенциальный злоумышленник может попытаться реализовать атаку брутфорсом на подобраные таким методом логины и, если пароли недостаточно надежны - без труда их подберет. Так же в приложении не реализована защита от неверного ввода пароля, т.е. злоумышленник может совершить неограниченое количество попыток входа в систему, а так же отсутсвует механизм мониторинга за попытками входа с одного адреса.
Решение: строгое регламентирование сложности паролей пользователей, запущенная на сервере IPS(Surricata), Rate Limit и Fail2ban